# hack-change-ml
Конечно! Вот пример содержания файла `README.md` для вашего проекта:

---

# Водное шеринг-такси: Прогнозирование времени поездки и риск-анализ

Проект представляет собой систему прогнозирования времени поездки водного шеринг-такси с использованием модели машинного обучения на основе данных о расписаниях, времени подхода и отхода судов, а также характеристик судов и причалов.

## Описание

В рамках данного проекта была построена модель для прогнозирования времени поездки водного шеринг-такси, которая использует следующие данные:

- Время подхода судна к причалу.
- Время отхода судна от причала.
- Признаки, такие как время суток (утро, вечер, ночь), которые могут влиять на время поездки.

Модель была обучена с использованием библиотеки `scikit-learn` и сохранена в формате `ONNX` для дальнейшего использования в реальных приложениях.

### Основные функции проекта:
1. **Прогнозирование времени поездки**: Модель использует входные данные о времени подхода и отхода судна для предсказания времени поездки.
2. **Риск-анализ**: Оценка загрузки причала на основе данных о вместимости судов и причалов.
3. **Обучение модели**: Система использует алгоритм случайного леса (`RandomForestRegressor`) для прогнозирования времени поездки.

## Требования

Для запуска проекта необходимы следующие библиотеки:

- `pandas` — для работы с данными.
- `scikit-learn` — для обучения модели машинного обучения.
- `onnx` — для работы с моделью в формате ONNX.
- `onnxruntime` — для предсказаний с помощью модели ONNX.
- `skl2onnx` — для преобразования модели в формат ONNX.

Вы можете установить все зависимости с помощью `pip`:

```bash
pip install pandas scikit-learn onnx onnxruntime skl2onnx
```

## Структура проекта

- `main.py` — основной скрипт для загрузки, очистки данных, обучения модели и выполнения предсказаний.
- `filtered_schedule_data.csv` — очищенные данные, которые используются для обучения модели.
- `water_taxi_model.onnx` — модель машинного обучения в формате ONNX, сохраненная после обучения.
- `README.md` — документация проекта.

## Пример использования

1. Запустите основной скрипт `main.py` для обучения модели и ее сохранения в формате ONNX.

2. Для использования модели на новых данных (например, от пользователя), вы можете использовать следующий код, который подает данные на вход модели и выводит предсказанное время поездки:

### Код для предсказания:

```python
import onnx
import onnxruntime as ort
import numpy as np

def load_model(onnx_model_path):
    # Загрузка модели
    return ort.InferenceSession(onnx_model_path)

def predict_trip_duration(model, input_data):
    # Преобразуем входные данные
    input_data = np.array(input_data).astype(np.float32).reshape(1, -1)
    
    # Получаем имя входного тензора
    input_name = model.get_inputs()[0].name
    
    # Выполняем предсказание
    prediction = model.run(None, {input_name: input_data})
    
    return prediction[0][0]

def get_user_input():
    # Получаем ввод от пользователя
    try:
        approach_time = float(input("Введите время подхода судна в минутах от начала суток: "))
        departure_time = float(input("Введите время отхода судна в минутах от начала суток: "))
        return [approach_time, departure_time]
    except ValueError:
        print("Ошибка: введите числовые значения для времени.")
        return None

def main():
    # Загружаем модель
    model_path = 'water_taxi_model.onnx'
    model = load_model(model_path)
    
    # Получаем данные от пользователя
    input_data = get_user_input()
    
    if input_data:
        # Получаем предсказание
        predicted_duration = predict_trip_duration(model, input_data)
        print(f"Предсказанное время поездки: {predicted_duration:.2f} минут")

if __name__ == "__main__":
    main()
```

### Пример вывода:

```
Введите время подхода судна в минутах от начала суток: 480
Введите время отхода судна в минутах от начала суток: 510
Предсказанное время поездки: 30.00 минут
```

3. Запустив этот код, модель использует введенные вами данные для предсказания времени поездки.

## Модель и её сохранение в формате ONNX

После обучения модели, она сохраняется в формате ONNX с помощью следующего кода:

```python
from skl2onnx import convert_sklearn
from skl2onnx.common.data_types import FloatTensorType
import onnx

# Преобразуем модель в формат ONNX
onnx_model = convert_sklearn(model, initial_types=[('float_input', FloatTensorType([None, X_train_scaled.shape[1]]))])

# Сохраняем модель в файл
onnx.save_model(onnx_model, 'water_taxi_model.onnx')
```

## Оценка качества модели

Мы оцениваем модель с помощью следующих метрик:

- **Mean Absolute Error (MAE)**: Средняя абсолютная ошибка, измеряется в минутах.
- **Root Mean Squared Error (RMSE)**: Корень из средней квадратичной ошибки, измеряется в минутах.
- **R-squared (R²)**: Коэффициент детерминации, который показывает, насколько хорошо модель объясняет вариацию в данных.

### Пример вывода качества модели:

```
Mean Absolute Error (MAE): 2.83 minutes
Root Mean Squared Error (RMSE): 15.05 minutes
R-squared (R²): 0.98
```

## Лицензия

Этот проект распространяется под лицензией MIT. Вы можете свободно использовать, модифицировать и распространять его.
